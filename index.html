<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Word Benzeri Editör</title>

  <!-- TinyMCE (API key ile) -->
  <script src="https://cdn.tiny.cloud/1/pds3kn2z4g058iovio38007sirlqb4vjpxxgiul81ua5o8vv/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>

  <!-- html-docx-js kütüphanesi (docx için) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.min.js"></script>

  <style>
    body {
      background: #d1d1d1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .toolbar {
      margin-bottom: 10px;
    }

    .word-page {
      width: 21cm;
      min-height: 29.7cm;
      padding: 2cm;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }

    button {
      padding: 8px 16px;
      margin: 0 5px;
      border: none;
      border-radius: 4px;
      background: #007bff;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }

    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>

<!-- Araç çubuğu -->
<div class="toolbar">
  <button onclick="saveAsDocx()">💾 Word olarak kaydet (.docx)</button>
  <button onclick="window.print()">🖨️ Yazdır</button>
  <input type="file" id="uploadFile" accept=".doc,.docx,.html,.txt" onchange="handleFile(event)">
</div>

<!-- Sayfa -->
<div class="word-page">
  <textarea id="editor">
    Buraya Word'den içerik yapıştırabilir ya da "☑ Kutucuk" ile tıklanabilir kutular ekleyebilirsin.
  </textarea>
</div>

<script>
  tinymce.init({
    selector: '#editor',
    height: 1000,
    menubar: true,
    plugins: [
      'image', 'table', 'lists', 'paste', 'code'
    ],
    toolbar: 'undo redo | styles | bold italic underline | alignleft aligncenter alignright | bullist numlist | insertCheckbox | table image | code',
    paste_data_images: true,
    content_style: `
      body {
        font-family: "Times New Roman", serif;
        font-size: 12pt;
        line-height: 1.5;
      }
      table, th, td {
        border: 1px solid #000;
        border-collapse: collapse;
      }
    `,
    setup: function (editor) {
      editor.ui.registry.addButton('insertCheckbox', {
        text: '☑ Kutucuk',
        tooltip: 'Tıklanabilir kutu ekle',
        onAction: function () {
          editor.insertContent('<input type="checkbox"> ');
        }
      });
    }
  });

  // Word (docx) olarak kaydetme
  function saveAsDocx() {
    const content = tinymce.get("editor").getContent();
    const converted = htmlDocx.asBlob(`<!DOCTYPE html><html><head><meta charset="utf-8"></head><body>${content}</body></html>`);
    saveAs(converted, 'belge.docx');
  }

  // Dosya yükleme
  function handleFile(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
      const extension = file.name.split('.').pop().toLowerCase();
      if (extension === "html" || extension === "txt") {
        tinymce.get("editor").setContent(e.target.result);
      } else if (extension === "doc" || extension === "docx") {
        alert("Word dosyaları doğrudan yüklenemez, lütfen kopyala–yapıştır yapın.");
      } else {
        alert("Desteklenmeyen dosya türü.");
      }
    };
    reader.readAsText(file);
  }
</script>

</body>
</html>
