<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>CKEditor 5 ile Word (.docx) ZIP Olarak Ä°ndir</title>

  <!-- CKEditor 5 Classic build -->
  <script src="https://cdn.ckeditor.com/ckeditor5/38.1.1/classic/ckeditor.js"></script>

  <!-- Gerekli kÃ¼tÃ¼phaneler -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <style>
    body {
      background: #f7f7f7;
      font-family: Arial, sans-serif;
      padding: 2rem;
    }
    #editor {
      min-height: 400px;
      background: white;
      padding: 1rem;
      box-shadow: 0 0 8px rgba(0,0,0,0.15);
    }
    button {
      margin-top: 1rem;
      padding: 12px 24px;
      font-weight: bold;
      background: #007bff;
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>

<h2>CKEditor 5 ile Word DosyasÄ±nÄ± ZIP Ä°Ã§inde Ä°ndir</h2>

<div id="editor">
  <h1>Merhaba CKEditor 5</h1>
  <p>Bu metni dÃ¼zenleyip Word dosyasÄ± olarak ZIP iÃ§inde indirebilirsiniz.</p>
</div>

<button id="saveBtn">ðŸ’¾ Word (.docx) ZIP Olarak Ä°ndir</button>

<script>
  let editorInstance;

  ClassicEditor
    .create(document.querySelector('#editor'), {
      toolbar: [
        'heading', '|',
        'bold', 'italic', 'underline', 'strikethrough', '|',
        'bulletedList', 'numberedList', 'todoList', '|',
        'link', 'blockQuote', 'insertTable', 'undo', 'redo'
      ],
      table: {
        contentToolbar: ['tableColumn', 'tableRow', 'mergeTableCells']
      }
    })
    .then(editor => {
      editorInstance = editor;
    })
    .catch(error => {
      console.error(error);
    });

  document.getElementById('saveBtn').addEventListener('click', async () => {
    if (!editorInstance) return alert('EditÃ¶r yÃ¼klenmedi!');

    const htmlContent = editorInstance.getData();

    const fullHtml = `
      <!DOCTYPE html>
      <html>
        <head><meta charset="utf-8"></head>
        <body>${htmlContent}</body>
      </html>
    `;

    // html-docx-js ile .docx dosyasÄ± oluÅŸtur
    const docxBlob = window.htmlDocx.asBlob(fullHtml);

    // JSZip ile ZIP dosyasÄ± oluÅŸtur ve iÃ§ine docx koy
    const zip = new JSZip();
    zip.file('belge.docx', docxBlob);

    const zipBlob = await zip.generateAsync({ type: 'blob' });

    // FileSaver ile indir
    saveAs(zipBlob, 'belge.zip');
  });
</script>

</body>
</html>
