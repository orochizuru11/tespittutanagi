<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>CKEditor5 + DOCX ZIP Ä°ndir</title>

<!-- CKEditor 5 Classic -->
<script src="https://cdn.ckeditor.com/ckeditor5/38.1.1/classic/ckeditor.js"></script>

<!-- Gerekli kÃ¼tÃ¼phaneler -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
  body {
    font-family: Arial, sans-serif;
    padding: 1rem 2rem;
    background: #f5f5f5;
  }
  #editor {
    min-height: 500px;
    background: white;
    padding: 1rem;
    box-shadow: 0 0 8px rgba(0,0,0,0.15);
    margin-bottom: 1rem;
  }
  button {
    background-color: #007bff;
    border: none;
    color: white;
    font-weight: bold;
    padding: 12px 30px;
    font-size: 1rem;
    border-radius: 6px;
    cursor: pointer;
  }
  button:hover {
    background-color: #0056b3;
  }
</style>
</head>
<body>

<h1>CKEditor 5 ile Word DosyasÄ±nÄ± ZIP Ä°Ã§inde Ä°ndir</h1>

<div id="editor">
  <h2>BaÅŸlÄ±k</h2>
  <p>Buraya metin yazabilir ya da yapÄ±ÅŸtÄ±rabilirsiniz.</p>
  <ul>
    <li>Madde 1</li>
    <li>Madde 2</li>
  </ul>
</div>

<button id="btnSave">ðŸ’¾ Word (.docx) ZIP Olarak Ä°ndir</button>

<script>
  let editorInstance;

  ClassicEditor
    .create(document.querySelector('#editor'), {
      toolbar: [
        'heading', '|',
        'bold', 'italic', 'underline', 'strikethrough', '|',
        'bulletedList', 'numberedList', 'todoList', '|',
        'link', 'blockQuote', 'insertTable', 'undo', 'redo'
      ],
      table: {
        contentToolbar: ['tableColumn', 'tableRow', 'mergeTableCells']
      }
    })
    .then(editor => {
      editorInstance = editor;
      console.log('CKEditor yÃ¼klendi.');
    })
    .catch(error => {
      console.error('CKEditor yÃ¼klenirken hata:', error);
      alert('EditÃ¶r yÃ¼klenirken hata oluÅŸtu. Konsolu kontrol et.');
    });

  document.getElementById('btnSave').addEventListener('click', async () => {
    if (!editorInstance) {
      alert('EditÃ¶r henÃ¼z yÃ¼klenmedi!');
      return;
    }

    try {
      const content = editorInstance.getData();
      const fullHtml = `
        <!DOCTYPE html>
        <html>
          <head><meta charset="utf-8"></head>
          <body>${content}</body>
        </html>
      `;

      // DOCX blob oluÅŸtur
      const docxBlob = window.htmlDocx.asBlob(fullHtml);

      // ZIP iÃ§ine ekle
      const zip = new JSZip();
      zip.file('belge.docx', docxBlob);

      // ZIP blob oluÅŸtur
      const zipBlob = await zip.generateAsync({ type: 'blob' });

      // Ä°ndir
      saveAs(zipBlob, 'belge.zip');
    } catch (e) {
      console.error('Dosya oluÅŸturulurken hata:', e);
      alert('Dosya oluÅŸturulurken hata oluÅŸtu. Konsolu kontrol edin.');
    }
  });
</script>

</body>
</html>
